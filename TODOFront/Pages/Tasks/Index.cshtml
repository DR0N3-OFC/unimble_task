@page
@model TODOFront.Pages.Tasks.IndexModel
@{
    ViewData["Title"] = "Planejaí - Cronogramas";
}
<style>
    body {
        background-color: #e9ecef;
    }

    .task-table {
        width: 80%;
        margin: 5vh auto;
        border-collapse: collapse;
        border-radius: 5px;
        overflow: hidden;
    }

    .task-table thead {
        position: relative;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .task-row {
        background-color: #fff;
    }

    .task-row td {
        padding: 10px;
        text-align: center;
    }

    .task-row td:first-child {
        width: 10%;
    }

    .task-row td:nth-child(2) {
        width: 50%;
    }

    .task-row td:nth-child(3) {
        width: 20%;
    }

    .task-row td:last-child {
        width: 20%;
    }

    .task-row input[type="checkbox"] {
        appearance: none;
        -webkit-appearance: none;
        width: 18px;
        height: 18px;
        border: 2px solid #ccc;
        border-radius: 4px;
        outline: none;
        cursor: pointer;
        vertical-align: middle;
        position: relative;
    }

    .task-row input[type="checkbox"]:checked {
        background-color: #007bff;
        border-color: #007bff;
    }

    .task-row input[type="checkbox"]:checked::before {
        content: "\2713";
        color: white;
        font-size: 14px;
        line-height: 18px;
        text-align: center;
        vertical-align: middle;
        display: block;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }

    .task-action {
        display: inline-block;
        margin-left: 10px;
    }

    .task-action:hover {
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        transition: box-shadow 0.3s ease;
        transform: scale(1.1);
    }

    .textbox {
        border: none;
        border-bottom: 1px solid #cfd8dc;
        background-color: transparent;
        padding: 5px 0 0 10px;
        font-size: 16px;
        outline: none;
        width: 80%;
    }

    .btn-add {
        width: 10%;
        font-size: 1em;
    }


    .icon {
        width: 20px;
    }

    .add-task {
        margin: auto;
        width: 80%;
        display: flex;
        justify-content: center;
        margin-top: 20px;
        display: flex;
        justify-content: space-around;
    }

    h2 {
        width: 100%;
        text-align: center;
        margin-bottom: 20px;
    }

    .checked-row td {
        color: #b3b3b3;
    }

    .checked-row .icon {
        opacity: 0.5;
    }

    .checked-row td p {
        text-decoration: line-through;
    }

    p {
        margin: 10px 0 5px;
        font-size: 1em;
    }
</style>


<div>
    <h2 class="text-center display-4">Suas tarefas</h2>

    <form method="post">
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        <div class="add-task">
            <input asp-for="NewTask.Description" type="text" class="textbox" placeholder="Nova tarefa..." />
            <span asp-validation-for="NewTask.Description" class="text-danger"></span>

            <input type="submit" class="btn btn-primary btn-add" value="Adicionar" />
        </div>
    </form>

    @if (Model.TasksList!.Count == 0)
    {
        <table class="task-table">
            <thead>
                <tr class="task-row">
                    <td></td>
                    <td>Tarefa</td>
                    <td>Status</td>
                    <td>Ações</td>
                </tr>
            </thead>
            <tbody>
                <tr class="task-row">
                    <td colspan="4">
                        <p>Você ainda não criou nenhuma tarefa.</p>
                    </td>
                </tr>
            </tbody>
        </table>
    }
    else
    {
        <table class="task-table">
            <thead>
                <tr class="task-row">
                    <td></td>
                    <td>Tarefa</td>
                    <td>Status</td>
                    <td>Ações</td>
                </tr>
            </thead>
            <tbody>
                @foreach (var task in Model.TasksList)
                {
                    if (task.Status == 0)
                    {
                        <tr class="task-row">
                            <td>
                                <form method="post" asp-page-handler="Edit" asp-route-id="@task.TaskId">
                                    <input type="checkbox" onchange="toggleRowOpacity(this); this.form.submit();" />
                                </form>
                            </td>
                            <td><p>@task.Description</p></td>
                            @if (task.Status == 0)
                            {
                                <td>Em andamento</td>
                            }
                            else
                            {
                                <td>Concluída</td>
                            }
                            <td>
                                <a asp-page="/Tasks/Edit" asp-route-id="@task.TaskId" class="task-action"><img class="icon" src="~/images/edit.png" alt="Editar"></a>
                                <a asp-page="/Tasks/Remove" asp-route-id="@task.TaskId" class="task-action"><img class="icon" src="~/images/delete.png" alt="Excluir"></a>
                            </td>
                        </tr>
                    }
                    else
                    {
                        <tr class="task-row checked-row">
                            <td>
                                <form method="post" asp-page-handler="Edit" asp-route-id="@task.TaskId">
                                    <input type="checkbox" onchange="toggleRowOpacity(this); this.form.submit();" checked />
                                </form>
                            </td>
                            <td><p>@task.Description</p></td>
                            @if (task.Status == 0)
                            {
                                <td>Em andamento</td>
                            }
                            else
                            {
                                <td>Concluída</td>
                            }
                            <td>
                                <a asp-page="/Tasks/Edit" asp-route-id="@task.TaskId" class="task-action"><img class="icon" src="~/images/edit.png" alt="Editar"></a>
                                <a asp-page="/Tasks/Remove" asp-route-id="@task.TaskId" class="task-action"><img class="icon" src="~/images/delete.png" alt="Excluir"></a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    }
</div>

<script>
    function toggleRowOpacity(checkbox) {
        var row = checkbox.parentNode.parentNode;
        if (checkbox.checked) {
            row.classList.add('checked-row');
        } else {
            row.classList.remove('checked-row');
        }
    }
</script>
